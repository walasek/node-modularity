<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Module.html">Module</a><ul class='methods'><li data-type='method'><a href="Module.html#moduleIsExclusive">moduleIsExclusive</a></li><li data-type='method'><a href="Module.html#modulePerformInjection">modulePerformInjection</a></li><li data-type='method'><a href="Module.html#setup">setup</a></li><li data-type='method'><a href="Module.html#teardown">teardown</a></li></ul></li><li><a href="SystemState.html">SystemState</a><ul class='methods'><li data-type='method'><a href="SystemState.html#addModuleClass">addModuleClass</a></li><li data-type='method'><a href="SystemState.html#bootstrap">bootstrap</a></li><li data-type='method'><a href="SystemState.html#resolveClass">resolveClass</a></li><li data-type='method'><a href="SystemState.html#setup">setup</a></li><li data-type='method'><a href="SystemState.html#teardown">teardown</a></li></ul></li></ul>
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3> </h3>		
    </section>









    



    <section class="readme usertext">
        <article><h1><a href="https://github.com/walasek/node-modularity">node-modularity</a></h1>
<p><a href="https://travis-ci.org/walasek/node-modularity"><img src="https://img.shields.io/travis/walasek/node-modularity.svg?style=flat-square" alt="Build Status"></a> <a href="https://www.npmjs.com/package/node-modularity"><img src="https://img.shields.io/npm/v/node-modularity.svg?style=flat-square" alt="Package Version"></a> <img src="https://img.shields.io/npm/l/node-modularity.svg?style=flat-square" alt="License"> <a href="https://david-dm.org/walasek/node-modularity"><img src="https://david-dm.org/walasek/node-modularity.svg" alt="Dependencies"></a>  <a href="https://codecov.io/gh/walasek/node-modularity"><img src="https://codecov.io/gh/walasek/node-modularity/branch/master/graph/badge.svg" alt="codecov"></a> <a href="https://snyk.io/test/github/walasek/node-modularity?targetFile=package.json"><img src="https://snyk.io/test/github/walasek/node-modularity/badge.svg?targetFile=package.json" alt="Known Vulnerabilities"></a></p>
<p>An easy dependency injection framework for any JavaScript application.</p>
<p><a href="https://walasek.github.io/node-modularity/">Documentation available here</a>.</p>
<hr>
<h2>Goal</h2>
<p>I've seen way too many JavaScript applications which don't properly handle their system state. Are you also tired of database connections held in global variables and singletons with unknown lifecycle? This framework is for you!</p>
<pre class="prettyprint source lang-javascript"><code>const { Module, SystemState } = require('node-modularity');

// Wrap your dependencies in modules
class DatabaseConnection extends Module {
  async setup(){
    this.db = await connectToMyDb();
    // ...
  }
}

class WebServer extends Module {
  async setup(){
    this.app = express();
    // ...
  }
}

// Define your own logic as modules too
class RESTEndpoints extends Module {
  constructor(){
    super({
      // Declare your dependencies
      inject: request => {
        this.database = request(DatabaseConnection),
        this.webserver = request(WebServer)
      }
    });
    // Dependencies are NOT available in the constructor
    this.database; // undefined
  }

  // Magically this will be called after the dependencies are ready!
  // No more lifecycle management!
  async setup(){
    this.webserver.app.get('/', (req, res) =>
      res.json(`Hello mr ${this.database.getUserData()}`)
    );
  }
}

// The system object will hold our state, no globals!
const system = new SystemState();
// Register known modules to be able to construct and inject them
system.addModuleClass(WebServer);
system.addModuleClass(DatabaseConnection);
system.addModuleClass(RESTEndpoints);
system.addModuleClass(SomeUnrelatedModule);

// Bootstrap will only construct these modules and their dependencies
// SomeUnrelatedModule will not be constructed even if it's registered
const modules = system.bootstrap({
  myRestEndpoints: RESTEndpoints
});
// const [myRestEndpoints] = system.bootstrap([RESTEndpoints]); would work too

// Setup will resolve your dependency graph in the right order
await system.setup();
modules.myRestEndpoints.webserver.app.listen(80);
// ...
// You can also define teardown methods and close the system in the proper order!
await system.teardown();
</code></pre>
<p>Features and remarks:</p>
<ul>
<li>Modules can optionally be <em>exclusive</em> meaning that a new instance is constructed for each injection. These exclusive modules can later depend on non-exclusive modules. Such a case will properly be handled creating a sort of a diamond dependency shape.</li>
<li>Modules can be referenced by an alias. Got a logger module that prints to console and another one that prints nothing, both with different classnames? Just register one with an alias! You can also use aliases when requesting modules for injection.</li>
<li>Currently the dependency graph cannot have cycles (A-&gt;B-&gt;C-&gt;A). In the future this will be handled by being able to declare one of the dependencies as <em>optional during setup</em>.</li>
<li>Currently the modules can only be created using a no-argument <em>new</em> call. In the future it will be possible to define a default factory function and to require exclusive modules with custom arguments per injection.</li>
<li>It is possible to avoid <code>addModuleClass</code> calls at all. An option might be added to enable <em>registering-during-injection</em> if a class is provided. This does introduce risk of injecting a wrong class if the name is popular (Logger etc.).</li>
<li>I might provide some extra modules that wrap some popular libraries such as Express or Mongo. This would enable instant prototyping of some simple web apps with this framework.</li>
</ul>
<h2>Installation</h2>
<p>Node <code>&gt;=8</code> is required.</p>
<pre class="prettyprint source lang-bash"><code>npm install --save node-modularity
</code></pre>
<p>To perform tests use:</p>
<pre class="prettyprint source lang-bash"><code>cd node_modules/node-modularity
npm i
npm t
</code></pre>
<h2>Usage</h2>
<p>Beware this project is still in development. There may be serious bugs or performance issues over time.</p>
<p>Documentation is available <a href="https://walasek.github.io/node-modularity/">here</a>.</p>
<h2>Contributing</h2>
<p>The source is documented with JSDoc. To generate the documentation use:</p>
<pre class="prettyprint source lang-bash"><code>npm run docs
</code></pre>
<p>Extra debugging information is printed using the <code>debug</code> module:</p>
<pre class="prettyprint source lang-bash"><code>DEBUG=modularity:* npm t
</code></pre>
<p>The documentation will be put in the new <code>docs</code> directory.</p>
<p>To introduce an improvement please fork this project, commit changes in a new branch to your fork and add a pull request on this repository pointing at your fork. Please follow these style recommendations when working on the code:</p>
<ul>
<li>Use <code>async</code>/<code>await</code> and/or <code>Promise</code> where possible.</li>
<li>Features must be properly tested.</li>
<li>New methods must be properly documented with <code>jscode</code> style comments.</li>
<li>Lint the project before committing</li>
</ul></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.5</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>